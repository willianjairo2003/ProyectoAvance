<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Productos</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f4f6f9;
  }

  /* Sidebar */
  .sidebar {
    min-height: 100vh;
    width: 240px;
    background: linear-gradient(180deg, #212529 0%, #343a40 100%);
    position: fixed;
    top: 0;
    left: 0;
    padding-top: 60px;
    color: #fff;
    transition: all 0.3s;
    box-shadow: 2px 0 10px rgba(0,0,0,0.2);
    z-index: 2000; /* encima del contenido */
  }
  .sidebar h4 { font-weight: bold; margin-top: 10px; margin-bottom: 20px; }
  .sidebar a { color: #adb5bd; padding: 12px 20px; display: block; text-decoration: none; font-size: 15px; border-left: 3px solid transparent; transition: 0.3s; }
  .sidebar a:hover, .sidebar a.active { background: #495057; color: #fff; border-left: 3px solid #0d6efd; }

  /* Navbar */
  .navbar { 
    margin-left: 240px; 
    transition: margin-left 0.3s; 
    box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
    z-index: 3000; /* SIEMPRE arriba */
  }
  .content { 
    margin-left: 240px; 
    padding: 20px; 
    padding-top: 80px; 
    transition: margin-left 0.3s; 
    position: relative; 
    z-index: 1000; /* debajo de navbar y sidebar */
  }

  

  @media (max-width: 991px) {
    .sidebar { left: -240px; }
    .sidebar.active { left: 0; }
    .navbar { margin-left: 0; }
    .content { margin-left: 0; padding-top: 80px; }
  }

  /* Botones de acción */
  .btn-action {
    border-radius: 50%;
    padding: 6px 9px;
  }
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar" id="sidebar">
  <h4 class="text-center"><i class="bi bi-person-circle me-2"></i>Admin</h4>
  <a href="dashboard"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a>
  <a href="productos" class="active"><i class="bi bi-box-seam me-2"></i>Productos</a>
  <a href="usuario"><i class="bi bi-people me-2"></i>Usuarios</a>
  <a href="pedido"><i class="bi bi-cart-check me-2"></i>Pedidos</a>
  <a href="reportes"><i class="bi bi-bar-chart-line me-2"></i>Reportes</a>
</div>

<!-- Navbar -->
<nav class="navbar navbar-expand navbar-dark bg-dark fixed-top">
  <div class="container-fluid">
    <button class="btn btn-outline-light d-lg-none me-2" id="toggleSidebar"><i class="bi bi-list"></i></button>
    <a class="navbar-brand fw-bold" href="#">Gestión de Productos</a>
    <ul class="navbar-nav ms-auto me-3">
      <li class="nav-item">
        <a class="nav-link" href="#"><i class="bi bi-person-circle me-1"></i> Perfil</a>
      </li>
      <li class="nav-item">
        <a class="nav-link text-danger" href="login"><i class="bi bi-box-arrow-right me-1"></i> Salir</a>
      </li>
    </ul>
  </div>
</nav>

<!-- Contenido principal -->
<div class="content">
  <h3 class="mb-4"><i class="bi bi-box-seam me-2"></i>Productos</h3>

  <!-- Botón agregar -->
  <div class="d-flex justify-content-between mb-3">
    <button class="btn btn-primary" onclick="abrirModal()">
      <i class="bi bi-plus-circle me-1"></i> Agregar Producto
    </button>
    <input type="text" id="buscarProducto" class="form-control w-25" placeholder="Buscar...">
  </div>

  <!-- Tabla -->
  <div class="card shadow-sm">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-dark">
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Precio</th>
              <th>Stock</th>
              <th>Imagen</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tablaProductos">
            <tr>
              <td>1</td>
              <td>Nike Air Zoom</td>
              <td>S/ 350</td>
              <td>20</td>
              <td><img src="/img/air270.png" class="img-thumbnail" style="max-width:80px; max-height:80px; width:auto; height:auto;"></td>
              <td>
                <button class="btn btn-sm btn-warning btn-action me-1" onclick="editarProducto(this)"><i class="bi bi-pencil"></i></button>
                <button class="btn btn-sm btn-danger btn-action" onclick="eliminarProducto(this)"><i class="bi bi-trash"></i></button>
              </td>
            </tr>
            <tr>
              <td>2</td>
              <td>Adidas Forum</td>
              <td>S/ 420</td>
              <td>15</td>
              <td><img src="/img/adidas.png" class="img-thumbnail" style="max-width:80px; max-height:80px; width:auto; height:auto;"></td>
              <td>
                <button class="btn btn-sm btn-warning btn-action me-1" onclick="editarProducto(this)"><i class="bi bi-pencil"></i></button>
                <button class="btn btn-sm btn-danger btn-action" onclick="eliminarProducto(this)"><i class="bi bi-trash"></i></button>
              </td>
            </tr>
            <tr>
              <td>3</td>
              <td>Air max 90</td>
              <td>S/ 310</td>
              <td>12</td>
              <td><img src="/img/airmax90mujer.png" class="img-thumbnail" style="max-width:80px; max-height:80px; width:auto; height:auto;"></td>
              <td>
                <button class="btn btn-sm btn-warning btn-action me-1" onclick="editarProducto(this)"><i class="bi bi-pencil"></i></button>
                <button class="btn btn-sm btn-danger btn-action" onclick="eliminarProducto(this)"><i class="bi bi-trash"></i></button>
              </td>
            </tr>
            <tr>
              <td>4</td>
              <td>New Balance 574</td>
              <td>S/ 280</td>
              <td>25</td>
              <td><img src="/img/newbalance.png" class="img-thumbnail" style="max-width:80px; max-height:80px; width:auto; height:auto;"></td>
              <td>
                <button class="btn btn-sm btn-warning btn-action me-1" onclick="editarProducto(this)"><i class="bi bi-pencil"></i></button>
                <button class="btn btn-sm btn-danger btn-action" onclick="eliminarProducto(this)"><i class="bi bi-trash"></i></button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</div>

<!-- Modal Agregar/Editar -->
<div class="modal fade" id="productoModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-lg"> <!-- centrado y ancho medio-grande -->
    <form class="modal-content" id="formProducto">
      <div class="modal-header bg-dark text-white">
        <h5 class="modal-title"><i class="bi bi-box-seam me-2"></i><span id="modalTitulo">Nuevo Producto</span></h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="productoId">
        <div class="mb-3">
          <label class="form-label">Nombre</label>
          <input type="text" id="productoNombre" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Precio</label>
          <input type="number" id="productoPrecio" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Stock</label>
          <input type="number" id="productoStock" class="form-control" required>
        </div>
        <div class="mb-3">
          <label class="form-label">Imagen (URL)</label>
          <input type="text" id="productoImagen" class="form-control">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn btn-primary" type="submit">Guardar</button>
      </div>
    </form>
  </div>
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
const modal = new bootstrap.Modal(document.getElementById('productoModal'));
let editandoFila = null;

// Abrir modal vacío (nuevo producto)
function abrirModal() {
  document.getElementById("modalTitulo").textContent = "Nuevo Producto";
  document.getElementById("formProducto").reset();
  document.getElementById("productoId").value = "";
  editandoFila = null;
  modal.show();
}

// Editar producto
function editarProducto(btn) {
  editandoFila = btn.closest("tr");
  document.getElementById("modalTitulo").textContent = "Editar Producto";

  document.getElementById("productoId").value = editandoFila.cells[0].textContent;
  document.getElementById("productoNombre").value = editandoFila.cells[1].textContent;
  document.getElementById("productoPrecio").value = editandoFila.cells[2].textContent.replace("S/ ","");
  document.getElementById("productoStock").value = editandoFila.cells[3].textContent;
  document.getElementById("productoImagen").value = editandoFila.cells[4].querySelector("img").src;

  modal.show();
}

// Guardar (nuevo o editado)
document.getElementById("formProducto").addEventListener("submit", function(e) {
  e.preventDefault();
  const id = document.getElementById("productoId").value || Date.now();
  const nombre = document.getElementById("productoNombre").value;
  const precio = "S/ " + document.getElementById("productoPrecio").value;
  const stock = document.getElementById("productoStock").value;
  const imagen = document.getElementById("productoImagen").value || "https://via.placeholder.com/60";

  if (editandoFila) {
    editandoFila.cells[1].textContent = nombre;
    editandoFila.cells[2].textContent = precio;
    editandoFila.cells[3].textContent = stock;
    editandoFila.cells[4].querySelector("img").src = imagen;
  } else {
    const tbody = document.getElementById("tablaProductos");
    const fila = tbody.insertRow();
    fila.innerHTML = `
      <td>${id}</td>
      <td>${nombre}</td>
      <td>${precio}</td>
      <td>${stock}</td>
      <td><img src="${imagen}" class="img-thumbnail"></td>
      <td>
        <button class="btn btn-sm btn-warning btn-action me-1" onclick="editarProducto(this)"><i class="bi bi-pencil"></i></button>
        <button class="btn btn-sm btn-danger btn-action" onclick="eliminarProducto(this)"><i class="bi bi-trash"></i></button>
      </td>`;
  }
  modal.hide();
});

// Eliminar producto
function eliminarProducto(btn) {
  if (confirm("¿Seguro que deseas eliminar este producto?")) {
    btn.closest("tr").remove();
  }
}

// Buscar producto
document.getElementById("buscarProducto").addEventListener("keyup", function() {
  let filter = this.value.toLowerCase();
  let rows = document.querySelectorAll("#tablaProductos tr");
  rows.forEach(row => {
    let text = row.textContent.toLowerCase();
    row.style.display = text.includes(filter) ? "" : "none";
  });
});

// Toggle sidebar
document.getElementById("toggleSidebar").addEventListener("click", () => {
  document.getElementById("sidebar").classList.toggle("active");
});
</script>

</body>
</html>
